/*
* jQuery imageHighlighter plug-in
* <http://wowmotty.blogspot.com/2010/06/imagehighlighter-v10.html>
*
* @v1.0   - 06-30-2010 (major overhaul of code & renaming of plugin)
* @author Rob G <wowmotty@gmail.com>
*/

(function($){$.imageHighlighter=function(e,m){var a=this;a.$el=$(e);a.el=e;a.$el.data("imageHighlighter",a);a.init=function(){a.options=$.extend({},$.imageHighlighter.defaultOptions,m);if(a.$el[0].tagName!="IMG")return false;a.$el.wrap("<div/>").before('<div class="imgHLDark"></div><div class="imgHLLight"></div>');if($(a.options.list).filter(".imgHLEdit").length)a.setupEdit();else a.options.editMode=false;var b=$(a.options.list).click(function(){return false});jQuery().hoverIntent?b.hoverIntent({over:function(){a.imgHLHover($(this))},
timeout:a.options.hoverTimeout,out:function(){a.imgHLUnhover()}}):b.hover(function(){a.imgHLHover($(this))},function(){a.imgHLUnhover()})};a.imgHLHover=function(b){if(b.attr("rel")!=""){b.addClass(a.options.current);var c=b.attr("rel").split(","),d=parseInt(a.options.borderSize,10),f=a.$el.parent(),i=a.$el.position().left,j=a.$el.position().top,g=parseInt(c[0],10)||0,h=parseInt(c[1],10)||0,k=parseInt(c[2],10)||0,l=parseInt(c[3],10)||0;f.find(".imgHLDark").css({height:a.$el.outerHeight()+1,width:a.$el.outerWidth()+
1,position:"absolute",top:j,left:i});a.$el.data("currentHighlight",b);f.find(".imgHLLight").css({background:"url("+a.$el.attr("src")+") -"+g+"px -"+h+"px no-repeat",position:"absolute",left:g+i-d,top:h+j-d,width:$.browser.msie?k+d*2-g:k-g,height:$.browser.msie?l+d*2-h:l-h,border:a.options.borderColor+" "+d+"px "+a.options.borderType,"z-index":a.options.zindex}).show();!a.options.editMode&&!a.options.lockMode&&a.options.overlay&&f.find(".imgHLDark").addClass("imgHLOverlay").css("z-index",parseInt(a.options.zindex,
10)-1).show();$(a.options.descripClass).html(b.parent().find(a.options.descrip).html());a.options.editMode&&f.find(".imgHLInfo").html("Highlight coordinates for "+b.html()+": "+c.join(", "))}};a.imgHLUnhover=function(){$(a.options.list).filter("."+a.options.current).removeClass(a.options.current);$(a.options.descripClass).empty();if(!a.options.editMode){var b=a.$el.parent();b.find(".imgHLDark").removeClass("imgHLOverlay");b.find(".imgHLLight").hide();a.$el.data("currentHighlight",null)}};a.setupEdit=
function(){a.$el.after('<div class="imgHLInfo"></div><div class="imgHLCoords"></div>');var b=a.$el.parent(),c=b.find(".imgHLDark, .imgHLLight").add(a.$el);$(a.options.list).filter(".imgHLEdit").wrap("<span/>").after('<span class="imgHLStatus"></span>').click(function(){a.options.editMode=!a.options.editMode;var d=$(a.options.list).filter(".imgHLEdit").parent().find(".imgHLStatus");d.text(a.options.editMode?" (enabled)":"");b.find(".imgHLDark").removeClass("imgHLOverlay");b.find(".imgHLLight").hide();
b.find(".imgHLCoords, .imgHLInfo").empty();if(a.options.editMode)c.css("cursor","crosshair");else{c.css("cursor","default");a.options.lockMode=false;d.removeClass("imgHLLocked")}return false});c.mousemove(function(d){a.options.editMode&&a.imgHLEditMove(d,this)}).click(function(){a.imgHLEditClick()})};a.imgHLEditMove=function(b){if(!a.options.lockMode){var c=document.all?event.clientX+$(window).scrollLeft():b.pageX;b=document.all?event.clientY+$(window).scrollTop():b.pageY;c=parseInt(c-a.$el.position().left,
10);b=parseInt(b-a.$el.position().top,10);a.$el.parent().find(".imgHLCoords").html("<span>X = "+c+"px, Y = "+b+"px</span> - Click to lock/unlock coordinates")}};a.imgHLEditClick=function(){if(a.options.editMode){a.options.lockMode=!a.options.lockMode;a.$el.parent().find(".imgHLCoords span").add($(a.options.list).filter(".imgHLEdit").parent().find(".imgHLStatus")).toggleClass("imgHLLocked",a.options.lockMode)}};a.highlight=function(b){if(typeof b!=="undefined"){a.imgHLUnhover();var c=$(a.options.list);
if(isNaN(b)){b=b.charAt(0).match(/\.|#/)?b:":contains("+b+")";c=c.filter(b+":first")}else{b=parseInt(b,10);b=b<$(a.options.list).length?b:0;c=c.eq(b-1)}c.length&&a.imgHLHover(c)}return a.$el.data("currentHighlight")||null};a.init()};$.imageHighlighter.defaultOptions={borderColor:"#fff",borderSize:4,borderType:"solid",list:"a",descrip:"p",descripClass:".description",overlay:true,current:"current",hoverTimeout:100,zindex:10,editMode:false,lockMode:false};$.fn.imageHighlighter=function(e){return this.each(function(){new $.imageHighlighter(this,
e)})};$.fn.getimageHighlighter=function(){this.data("imageHighlighter")}})(jQuery);
